(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{"7i70":function(e,t,r){"use strict";(function(e,n){r.d(t,"a",function(){return w});var a=r("gDde"),o=r("co3k"),i=r("z4Qk"),c=r("qoM+"),u=r("jdJj"),l=r("PyG4"),s=r("Aimb"),d=r.n(s);function f(){return(f=Object.assign||function(e){for(var t=1;arguments.length>t;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function p(e){for(var t=1;arguments.length>t;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(r,!0).forEach(function(t){v(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(r).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function m(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var b=e.t("Change Department"),y=e.t("Choose a department"),g=n(u.b.Footer,null),w=function(t){var r,a;function s(e){var r;v(m(r=t.call(this,e)||this),"state",{department:null}),v(m(r),"validations",{department:[c.e.nonEmpty]}),v(m(r),"getValidableFields",function(){return Object.keys(r.validations).map(function(e){return r.state[e]?p({fieldName:e},r.state[e]):null}).filter(Boolean)}),v(m(r),"validate",function(e){var t=e.value;return r.validations[e.name].reduce(function(e,r){return e||r({value:t})},void 0)}),v(m(r),"validateAll",function(){var e=r.getValidableFields(),t=Array.isArray(e),n=0;for(e=t?e:e[Symbol.iterator]();;){var a,o;if(t){if(n>=e.length)break;o=e[n++]}else{if((n=e.next()).done)break;o=n.value}var i=o.fieldName,c=o.value,u=r.validate({name:i,value:c});r.setState(((a={})[i]=p({},r.state[i],{value:c,error:u,showError:!1}),a))}}),v(m(r),"isValid",function(){return r.getValidableFields().every(function(e){return!(void 0===e?{}:e).error})}),v(m(r),"handleFieldChange",function(e){return function(t){var n,a=t.target.value,o=r.validate({name:e,value:a});r.setState(((n={})[e]=p({},r.state[e],{value:a,error:o,showError:!1}),n))}}),v(m(r),"handleDepartmentChange",r.handleFieldChange("department")),v(m(r),"handleSubmit",function(e){if(e.preventDefault(),r.props.onSubmit){var t=Object.entries(r.state).filter(function(e){return null!==e[1]}).map(function(e){var t;return(t={})[e[0]]=e[1].value,t}).reduce(function(e,t){return p({},e,{},t)},{});r.props.onSubmit(t)}}),v(m(r),"handleCancelClick",function(){var e=r.props.onCancel;e&&e()});var n=e.departments;return n&&n.length>0&&(r.state.department={value:""}),r.validateAll(),r}a=t,(r=s).prototype=Object.create(a.prototype),r.prototype.constructor=r,r.__proto__=a;var h=s.prototype;return h.componentWillReceiveProps=function(){this.state.department||this.setState({department:p({},this.state.department,{value:""})})},h.render=function(t,r){var a=r.department,s=t.title,h=t.color,p=t.message,m=t.loading,v=t.departments,w=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;o.length>n;n++)0>t.indexOf(r=o[n])&&(a[r]=e[r]);return a}(t,["title","color","message","loading","departments"]),O=this.isValid();return n(u.b,f({color:h,title:s||b,className:Object(l.d)(d.a,"switch-department")},w),n(u.b.Content,null,n("p",{className:Object(l.d)(d.a,"switch-department__message")},p||y),n(c.a,{onSubmit:this.handleSubmit},n(c.b,{label:e.t("Departments"),error:a&&a.showError&&a.error},n(c.c,{name:"department",value:a&&a.value,options:v.map(function(e){return{value:e._id,label:e.name}}),placeholder:e.t("Choose a department..."),disabled:m,error:a&&a.showError,onInput:this.handleDepartmentChange})),n(i.a,null,n(o.a,{submit:!0,loading:m,disabled:!O||m,stack:!0},e.t("Start chat")),n(o.a,{disabled:m,stack:!0,secondary:!0,nude:!0,onClick:this.handleCancelClick},e.t("Cancel"))))),g)},s}(a.Component)}).call(this,r("fsQa").default,r("gDde").h)},POey:function(e,t,r){"use strict";r.r(t);var n=r("7i70");r.d(t,"SwitchDepartment",function(){return n.a});var a=r("xFLU");r.d(t,"SwitchDepartmentContainer",function(){return a.b}),r.d(t,"SwitchDepartmentConnector",function(){return a.a}),r.d(t,"default",function(){return a.c})},xFLU:function(e,t,r){"use strict";(function(e,n){r.d(t,"b",function(){return m}),r.d(t,"a",function(){return v});var a=r("gDde"),o=r("qPgm"),i=r("UEyv"),c=r("kQFM"),u=r("7i70"),l=r("81xT"),s=r("PyG4"),d=r("SGp1");function f(){return(f=Object.assign||function(e){for(var t=1;arguments.length>t;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var m=function(t){var r,a;function c(){for(var r,a=arguments.length,c=new Array(a),m=0;a>m;m++)c[m]=arguments[m];return p(h(r=t.call.apply(t,[this].concat(c))||this),"confirmChangeDepartment",function(){return new Promise(function(t,r){var n;return Promise.resolve(l.a.confirm({text:e.t("Are you sure you want to switch the department?")})).then(function(e){try{return t("boolean"==typeof(n=e).success&&n.success)}catch(e){return r(e)}},r)})}),p(h(r),"handleSubmit",function(t){return new Promise(function(n,a){var c,u,f,h,p,m;return u=(c=r.props).alerts,f=c.dispatch,h=c.room,p=c.token,m=t.department,Promise.resolve(r.confirmChangeDepartment()).then(function(t){try{if(!t)return n();if(!h)return Promise.resolve(o.a.grantVisitor({visitor:{department:m,token:p}})).then(function(t){try{return Promise.resolve(f({user:t,alerts:(u.push({id:Object(s.e)(),children:e.t("Department switched"),success:!0}),u)})).then(function(){try{return n(d.a.go(-1))}catch(e){return a(e)}},a)}catch(e){return a(e)}},a);var r=function(e){return function(t){try{return Promise.resolve(f({loading:!1})).then(function(){try{return e&&e.call(this,t)}catch(e){return a(e)}}.bind(this),a)}catch(e){return a(e)}}.bind(this)}.bind(this);return Promise.resolve(f({loading:!0})).then(function(){try{var t=function(){try{return n()}catch(e){return a(e)}},c=function(){try{return Promise.resolve(f({alerts:(u.push({id:Object(s.e)(),children:e.t("No available agents to transfer"),warning:!0}),u)})).then(function(){try{return r(t)()}catch(e){return a(e)}},a)}catch(e){return r(a)(e)}};try{return Promise.resolve(o.a.transferChat({rid:h._id,department:m})).then(function(n){try{if(!n.success)throw e.t("No available agents to transfer");return Promise.resolve(f({department:m,loading:!1})).then(function(){try{return Promise.resolve(Object(i.a)()).then(function(){try{return Promise.resolve(l.a.alert({text:e.t("Department switched")})).then(function(){try{return d.a.go(-1),r(t)()}catch(e){return c()}},c)}catch(e){return c()}},c)}catch(e){return c()}},c)}catch(e){return c()}},c)}catch(e){c()}}catch(e){return a(e)}},a)}catch(e){return a(e)}}.bind(this),a)})}),p(h(r),"handleCancel",function(){d.a.go(-1)}),p(h(r),"render",function(e){return n(u.a,f({},e,{onSubmit:r.handleSubmit,onCancel:r.handleCancel}))}),r}return a=t,(r=c).prototype=Object.create(a.prototype),r.prototype.constructor=r,r.__proto__=a,c}(a.Component),v=function(e){var t=e.ref,r=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;o.length>n;n++)0>t.indexOf(r=o[n])&&(a[r]=e[r]);return a}(e,["ref"]);return n(c.a,null,function(e){var a=e.config,o=(a=void 0===a?{}:a).departments,i=a.theme;i=void 0===i?{}:i;var c=e.iframe,u=(c=void 0===c?{}:c).theme,l=e.room,s=e.loading,d=e.department,h=e.dispatch,p=e.alerts,v=e.token;return n(m,f({ref:t},r,{theme:{color:(u=void 0===u?{}:u).color||i.color,fontColor:u.fontColor,iconColor:u.iconColor},loading:void 0!==s&&s,departments:(void 0===o?{}:o).filter(function(e){return e.showOnRegistration&&e._id!==d}),dispatch:h,room:l,alerts:p,token:v}))})};t.c=v}).call(this,r("fsQa").default,r("gDde").h)}}]);